это dao

тут очень много технической логики